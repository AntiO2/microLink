# ===================================================================
# Microlink Statistics Service Configuration
# ===================================================================

# --- Application General ---
spring.application.name=microlink-statistics
# 定义内嵌 web 服务器（如 Tomcat）的运行端口
server.port=8081 # 使用 8081 端口，以防 8080 端口已被其他服务占用

# --- MySQL Datasource ---
spring.datasource.url=jdbc:mysql://localhost:3306/microlink_stats?useUnicode=true&characterEncoding=utf8&serverTimezone=UTC
# 数据库用户名 (请根据您的 MySQL 设置修改)
spring.datasource.username=microlink
# 数据库密码 (请根据您的 MySQL 设置修改)
spring.datasource.password=microlink_stats
# MySQL 8+ 的驱动程序类名
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# --- JPA & Hibernate ---
# Hibernate DDL (数据定义语言) 自动生成策略。
# 'update': 启动时检查实体类和数据库表的差异，如果表不存在则创建，如果表结构有变动则更新，但不会删除列。非常适合开发阶段。
spring.jpa.hibernate.ddl-auto=update
# 在控制台打印 Hibernate 生成的 SQL 语句，方便调试
spring.jpa.show-sql=true
# 指定 Hibernate 使用的数据库方言，以生成针对 MySQL 8 优化的 SQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

# --- Redis Cache ---
# Redis 服务器地址
spring.redis.host=localhost
# Redis 服务器端口
spring.redis.port=6379
# 如果您的 Redis 服务器设置了密码，请取消此行的注释并填入密码
spring.redis.password=redispassword

# --- Apache Kafka Consumer ---
# Kafka Broker (消息代理) 的地址
spring.kafka.bootstrap-servers=localhost:9092
# 消费者组 ID。同一个组内的消费者会共同消费一个 topic 的消息，确保每条消息只被组内一个消费者处理。
spring.kafka.consumer.group-id=statistics-group
# 当没有初始偏移量或当前偏移量在服务器上不存在时，消费者从哪里开始读取消息。
# 'earliest': 自动将偏移量重置为最早的偏移量，即从头开始消费。
# 'latest': 自动将偏移量重置为最新的偏移量，即只消费启动后产生的新消息。
# 对于统计服务，'earliest' 更安全，可以防止因服务重启而丢失数据。
spring.kafka.consumer.auto-offset-reset=earliest
# Key 的反序列化器
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
# Value 的反序列化器，用于将 JSON 字符串转换为 Java 对象
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
# 这是使用 JsonDeserializer 时一个非常重要的安全配置！
# 它告诉 Kafka 哪些包下的类是可信的，允许被反序列化。
# '*' 表示信任所有包，在开发环境中很方便。在生产环境中建议指定具体的包名，例如 'com.example.microlink_statistics.dto'。
spring.kafka.consumer.properties.spring.json.trusted.packages=*

# --- Logging ---
# 设置根日志级别
logging.level.root=INFO
# 为我们的项目包设置更详细的日志级别 (DEBUG)，方便开发时查看更多信息
logging.level.com.example.microlink_statistics=DEBUG
